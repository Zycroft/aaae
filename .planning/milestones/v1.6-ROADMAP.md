# Roadmap: Agentic Copilot Chat App

## Milestones

- âœ… **v1.0 MVP** â€” Phases 1â€“3 (shipped 2026-02-20)
- âœ… **v1.1 Polish** â€” Phase 4 (shipped 2026-02-20)
- âœ… **v1.2 Auth** â€” Phases 5â€“7 (shipped 2026-02-21)
- âœ… **v1.3b Copilot Studio SDK: Orchestrator Readiness** â€” Phases 8â€“10 (shipped 2026-02-21)
- âœ… **v1.4 Persistent State Store** â€” Phases 11â€“14 (shipped 2026-02-22)
- âœ… **v1.5 Workflow Orchestrator + Structured Output Parsing** â€” Phases 15â€“18 (shipped 2026-02-22)
- ðŸš§ **v1.6 Dynamic Step-Driven UX** â€” Phases 19â€“22 (in progress)

## Phases

<details>
<summary>âœ… v1.0 MVP (Phases 1â€“3) â€” SHIPPED 2026-02-20</summary>

- [x] Phase 1: Scaffold + Schema + Server Foundation (4/4 plans) â€” completed 2026-02-20
- [x] Phase 2: Text Chat End-to-End (4/4 plans) â€” completed 2026-02-20
- [x] Phase 3: Adaptive Cards + Accessibility + Theming (5/5 plans) â€” completed 2026-02-20

Full phase details: `.planning/milestones/v1.0-ROADMAP.md`

</details>

<details>
<summary>âœ… v1.1 Polish (Phase 4) â€” SHIPPED 2026-02-20</summary>

- [x] Phase 4: Polish, Metadata Drawer, CI, and Docs (3/3 plans) â€” completed 2026-02-20

Full phase details: `.planning/milestones/v1.1-ROADMAP.md`

</details>

<details>
<summary>âœ… v1.2 Entra External ID Authentication (Phases 5â€“7) â€” SHIPPED 2026-02-21</summary>

- [x] Phase 5: Shared Schema + Config Foundation (2/2 plans) â€” completed 2026-02-21
- [x] Phase 6: Server JWT Validation + Org Allowlist (2/2 plans) â€” completed 2026-02-21
- [x] Phase 7: Client MSAL Authentication (3/3 plans) â€” completed 2026-02-21

Full phase details: `.planning/milestones/v1.2-ROADMAP.md`

</details>

<details>
<summary>âœ… v1.3b Copilot Studio SDK: Orchestrator Readiness (Phases 8â€“10) â€” SHIPPED 2026-02-21</summary>

- [x] Phase 8: SDK Capability Audit + Structured Extraction (3/3 plans) â€” completed 2026-02-21
- [x] Phase 9: Context Injection + Multi-Turn Validation (3/3 plans) â€” completed 2026-02-21
- [x] Phase 10: Orchestrate Endpoint + Evaluation (3/3 plans) â€” completed 2026-02-21

Full phase details: `.planning/milestones/v1.3b-ROADMAP.md`

</details>

<details>
<summary>âœ… v1.4 Persistent State Store (Phases 11â€“14) â€” SHIPPED 2026-02-22</summary>

- [x] Phase 11: StoredConversation Schema + Store Abstraction (2/2 plans) â€” completed 2026-02-22
- [x] Phase 12: Redis Implementation + Resilience (2/2 plans) â€” completed 2026-02-22
- [x] Phase 13: Route Integration + Tests (1/1 plan) â€” completed 2026-02-22
- [x] Phase 14: Redis Error Differentiation (1/1 plan) â€” completed 2026-02-22

Full phase details: `.planning/milestones/v1.4-ROADMAP.md`

</details>

<details>
<summary>âœ… v1.5 Workflow Orchestrator + Structured Output Parsing (Phases 15â€“18) â€” SHIPPED 2026-02-22</summary>

- [x] Phase 15: Parser + Context Builder (3/3 plans) â€” completed 2026-02-22
- [x] Phase 16: Workflow Orchestrator Engine (3/3 plans) â€” completed 2026-02-22
- [x] Phase 17: Route Integration + Compatibility (3/3 plans) â€” completed 2026-02-22
- [x] Phase 18: Phase 16 Verification + Requirement Closure (2/2 plans) â€” completed 2026-02-22

Full phase details: `.planning/milestones/v1.5-ROADMAP.md`

</details>

### ðŸš§ v1.6 Dynamic Step-Driven UX (In Progress)

**Milestone Goal:** Make the client workflow-aware â€” render server-driven progress, dynamic input modes, phase dividers, and completion summaries so the AI-driven orchestrator can guide users through multi-step workflows.

- [x] **Phase 19: WorkflowState Schema + Client State Foundation** â€” Extend shared/ Zod schemas and wire useChatApi hook to track workflow state (completed 2026-02-23)
  - **Plans**: 2 plans
  - [ ] 19-01-PLAN.md â€” Extend WorkflowState schema with v1.6 UX fields (TDD)
  - [ ] 19-02-PLAN.md â€” Update chatApi return types + useChatApi state + resetConversation
- [x] **Phase 20: Shell Wiring + Progress Indicator + Transcript** â€” Wire ChatShell, render WorkflowProgress bar, add phase dividers and system messages (completed 2026-02-23)
  - **Plans**: 3 plans
  - [ ] 20-01-PLAN.md â€” WorkflowProgress component + unit tests (TDD)
  - [ ] 20-02-PLAN.md â€” Transcript phase dividers + orchestrator status messages
  - [ ] 20-03-PLAN.md â€” ChatShell wiring: WorkflowProgress integration + error state
- [x] **Phase 21: Dynamic Input + Completion + MetadataPane** â€” Dynamic ChatInput modes, WorkflowComplete view, MetadataPane workflow data section (completed 2026-02-23)
- [x] **Phase 22: Integration Testing** â€” End-to-end multi-step workflow integration test validating full phase-transition cycle (completed 2026-02-23)

## Phase Details

### Phase 19: WorkflowState Schema + Client State Foundation
**Goal**: The shared type contract for workflow state exists and the client hook tracks it â€” all downstream UI components have a typed, reactive source of truth to consume
**Depends on**: Phase 18 (v1.5 complete; server already returns workflowState)
**Requirements**: SCHEMA-01, SCHEMA-02, SCHEMA-03, STATE-01, STATE-02, STATE-03, COMPAT-01, COMPAT-02
**Success Criteria** (what must be TRUE):
  1. WorkflowState Zod schema exists in shared/ with all required fields (status, currentPhase, progress, collectedData, suggestedInputType, choices) and TypeScript types are inferred from it
  2. SendMessageResponse and CardActionResponse schemas include an optional workflowState field that passes Zod validation with or without it present
  3. useChatApi hook exposes workflowState and resetConversation() to consumers, updating state on every send/cardAction response
  4. A chat session with no workflowState in the server response renders identically to v1.1 â€” no regression, no broken layout
  5. No hardcoded phase names or step counts appear anywhere in client code â€” all workflow rendering data flows from server response
**Plans**: 2 plans

Plans:
- [ ] 19-01-PLAN.md â€” Extend WorkflowState schema with v1.6 UX fields (TDD)
- [ ] 19-02-PLAN.md â€” Update chatApi return types + useChatApi state + resetConversation

### Phase 20: Shell Wiring + Progress Indicator + Transcript
**Goal**: The chat shell passes workflow state to child components and the transcript visually reflects workflow progress â€” users see a phase label, a progress bar, and clear dividers between workflow phases
**Depends on**: Phase 19
**Requirements**: SHELL-01, SHELL-02, PROG-01, PROG-02, PROG-03, TRANS-01, TRANS-02, COMPAT-03, TEST-01
**Success Criteria** (what must be TRUE):
  1. WorkflowProgress component appears above the transcript when a workflow is active, showing the currentPhase label and a filled progress bar (0â€“100%) or a pulsing indeterminate bar when progress is null
  2. WorkflowProgress hides completely when no workflow is active, with no layout shift
  3. Phase transitions animate smoothly â€” changing from one phase to the next does not flicker or jump
  4. Phase divider lines appear in the transcript at the point where currentPhase changes between consecutive messages
  5. Orchestrator status messages render as centered, muted text without speech bubbles â€” visually distinct from user/assistant messages
  6. ChatShell surfaces a visible error state with a retry option when workflowState.status is 'error'
  7. All new components are responsive at 360px, 768px, and 1280px widths and render correctly in both dark and light themes
**Plans**: 3 plans

Plans:
- [ ] 20-01-PLAN.md â€” WorkflowProgress component + unit tests (TDD)
- [ ] 20-02-PLAN.md â€” Transcript phase dividers + orchestrator status messages
- [ ] 20-03-PLAN.md â€” ChatShell wiring: WorkflowProgress integration + error state

### Phase 21: Dynamic Input + Completion + MetadataPane
**Goal**: The chat input adapts to the workflow's requested mode, the completion view summarizes what was collected, and the metadata pane exposes accumulated workflow data â€” users can interact with the workflow using keyboard or pointer at every step
**Depends on**: Phase 20
**Requirements**: INPUT-01, INPUT-02, INPUT-03, INPUT-04, INPUT-05, COMPL-01, COMPL-02, COMPL-03, META-01, META-02, TEST-02, TEST-03
**Success Criteria** (what must be TRUE):
  1. When suggestedInputType is 'choice', ChatInput renders clickable pill buttons for each choice; selecting one sends the choice text; free-text input remains available as a fallback
  2. When suggestedInputType is 'confirmation', ChatInput renders Yes and No buttons; free-text input remains available as a fallback
  3. When suggestedInputType is 'none', ChatInput shows a visible disabled state with a status message explaining why input is unavailable
  4. Choice pill overflow beyond six items shows a "Show more" toggle; all pill buttons and confirmation buttons are keyboard accessible (Tab, Enter, Space)
  5. When workflowState.status is 'completed', WorkflowComplete renders with the collected data summary, a "Start new conversation" button that resets state, and a "Download summary" button that exports collected data as JSON
  6. MetadataPane shows a "Workflow Data" section with accumulated collectedData key-value pairs; nested objects up to three levels deep are displayed inline; deeper structures show a "View full data" JSON viewer toggle
**Plans**: TBD

### Phase 22: Integration Testing
**Goal**: A single integration test simulates a complete multi-step workflow from start to finish, verifying that phase transitions, input mode changes, and completion rendering all work in sequence â€” giving confidence that the assembled system behaves as designed
**Depends on**: Phase 21
**Requirements**: TEST-04
**Success Criteria** (what must be TRUE):
  1. An integration test drives a simulated multi-step workflow through at least two phase transitions and at least two different input modes (e.g., choice then confirmation), asserting the correct UI state at each step
  2. The test verifies that resetConversation() returns the UI to its initial state with no workflow artifacts visible
  3. All 30 v1.6 requirements are verified green (unit tests for components, integration test for full flow)
**Plans**: 1 plan

Plans:
- [ ] 22-01-PLAN.md â€” Integration test: full workflow lifecycle simulation (idle -> choice -> confirmation -> completed -> reset)

## Progress

| Phase | Milestone | Plans Complete | Status | Completed |
|-------|-----------|----------------|--------|-----------|
| 1. Scaffold + Schema + Server Foundation | v1.0 | 4/4 | Complete | 2026-02-20 |
| 2. Text Chat End-to-End | v1.0 | 4/4 | Complete | 2026-02-20 |
| 3. Adaptive Cards + Accessibility + Theming | v1.0 | 5/5 | Complete | 2026-02-20 |
| 4. Polish, Metadata Drawer, CI, and Docs | v1.1 | 3/3 | Complete | 2026-02-20 |
| 5. Shared Schema + Config Foundation | v1.2 | 2/2 | Complete | 2026-02-21 |
| 6. Server JWT Validation + Org Allowlist | v1.2 | 2/2 | Complete | 2026-02-21 |
| 7. Client MSAL Authentication | v1.2 | 3/3 | Complete | 2026-02-21 |
| 8. SDK Capability Audit + Structured Extraction | v1.3b | 3/3 | Complete | 2026-02-21 |
| 9. Context Injection + Multi-Turn Validation | v1.3b | 3/3 | Complete | 2026-02-21 |
| 10. Orchestrate Endpoint + Evaluation | v1.3b | 3/3 | Complete | 2026-02-21 |
| 11. StoredConversation Schema + Store Abstraction | v1.4 | 2/2 | Complete | 2026-02-22 |
| 12. Redis Implementation + Resilience | v1.4 | 2/2 | Complete | 2026-02-22 |
| 13. Route Integration + Tests | v1.4 | 1/1 | Complete | 2026-02-22 |
| 14. Redis Error Differentiation | v1.4 | 1/1 | Complete | 2026-02-22 |
| 15. Parser + Context Builder | v1.5 | 3/3 | Complete | 2026-02-22 |
| 16. Workflow Orchestrator Engine | v1.5 | 3/3 | Complete | 2026-02-22 |
| 17. Route Integration + Compatibility | v1.5 | 3/3 | Complete | 2026-02-22 |
| 18. Phase 16 Verification + Requirement Closure | v1.5 | 2/2 | Complete | 2026-02-22 |
| 19. WorkflowState Schema + Client State Foundation | 2/2 | Complete    | 2026-02-23 | - |
| 20. Shell Wiring + Progress Indicator + Transcript | 3/3 | Complete    | 2026-02-23 | - |
| 21. Dynamic Input + Completion + MetadataPane | 3/3 | Complete    | 2026-02-23 | - |
| 22. Integration Testing | 1/1 | Complete    | 2026-02-23 | - |
